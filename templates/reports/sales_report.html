{% extends "base.html" %}
{% block content %}

<h2>Sales Report</h2>

<div style="display:flex; gap:20px; margin-bottom:20px; align-items:flex-end;">
    <div>
        <label>Select Report</label>
        <select id="report-select" style="padding:6px; width:200px;">
            <option value="/reports/stock"  {% if 'stock' in request.path %}selected{% endif %}>Stock Report</option>
            <option value="/reports/sales"  {% if 'sales' in request.path %}selected{% endif %}>Sales Report</option>
            <option value="/reports/expiry" {% if 'expiry' in request.path %}selected{% endif %}>Expiry Report</option>
        </select>
    </div>
</div>

<script>
document.getElementById('report-select').addEventListener('change', function() {
    window.location.href = this.value;
});
</script>

<!-- â­ ADD TABLE ID -->
<table id="salesTable" border="0" cellpadding="6" cellspacing="0" style="width:100%; background:white; border-radius:8px; overflow:hidden;">

    <thead style="background:#f1f1f1;">
        <tr>
            <th onclick="sortTable('salesTable', 0)" style="cursor:pointer;" align="left">Invoice</th>
            <th onclick="sortTable('salesTable', 1)" style="cursor:pointer;" align="left">Customer</th>
            <th onclick="sortTable('salesTable', 2)" style="cursor:pointer;" align="left">Date</th>
            <th onclick="sortTable('salesTable', 3)" style="cursor:pointer;" align="right">Total</th>
        </tr>
    </thead>

    <tbody>
        {% set grand = 0 %}
        {% for s in sales.items %}
        {% set grand = grand + (s.total or 0) %}
        <tr style="border-bottom:1px solid #eee;">
            <td>{{ s.invoice_no }}</td>
            <td>{{ s.customer_id or '-' }}</td>
            <td>{{ s.date.strftime("%Y-%m-%d %H:%M") }}</td>
            <td align="right">{{ "%.2f"|format(s.total or 0) }}</td>
        </tr>
        {% else %}
        <tr>
            <td colspan="4" style="text-align:center; padding:15px; color:#777;">
                No sales found for this date.
            </td>
        </tr>
        {% endfor %}
    </tbody>

    <tfoot>
        <tr>
            <td colspan="3" align="right"><strong>Total:</strong></td>
            <td align="right"><strong>{{ "%.2f"|format(total or 0) }}</strong></td>
        </tr>
    </tfoot>

</table>

<div style="text-align: right; margin-top: 15px;">
    {% if sales.has_prev %}
        <a href="{{ url_for('report_sales', page=sales.prev_num) }}" class="btn btn-secondary">Previous</a>
    {% endif %}
    {% if sales.has_next %}
        <a href="{{ url_for('report_sales', page=sales.next_num) }}" class="btn btn-primary">Next</a>
    {% endif %}
</div>

{% endblock %}
